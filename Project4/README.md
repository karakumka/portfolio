# Платформа автоматического разбора и структурирования сценариев

Подготовка документации на основе текстового сценария - одна из самых трудоемких задач препродакшена. Ассистенты режиссеров и продюсеры вручную разбивают сценарий на сцены, определяют локации, время суток, перечисляют персонажей, массовку, реквизит и спецэффекты. 

**Задача:** автоматизировать разбор сценария, чтобы снизить риски простоя съемочного процесса.

**Решение:**

1) Очистили и нормализовали сценарии, разметили данные и обучили трансформерную NER-модель для извлечения сущностей.
2) Собрали backend в Docker, подняли сервер с API и сделали десктопное приложение под Windows, которое отправляет файлы на сервер и возвращает готовый Excel с разбором сцен.

Демонстрация (скринкаст): https://disk.yandex.ru/i/Yi16YstNXTlxbQ 

## 1. Локальная проверка 

По умолчанию скрипт ожидает папку с весами модели по пути `./ner_rubert_best_1763076515`.

Чтобы запустить решение локально, необходимо:

1) Скачать архив с моделью по ссылке: [Я.Диск](https://disk.yandex.ru/d/XwyNkNLi6Qc-vQ)
   
2) Распаковать содержимое в папку `ner_rubert_best_1763076515` в корне проекта.

3) Запустить терминал из папки, где лежит `main.py`

4) Импортировать все необходимые зависимости:

`python -m pip install -r requirements.txt`

`python -m spacy download ru_core_news_sm`

5) Запустить скрипт:

`python main.py <input_file> <output_file>`

**Пример команды:**

`python main.py "E:\WINK\Input.docx" "E:\WINK\Output.xlsx"`

## 2. Docker

Чтобы установить Docker, нужно выполнить следующую команду:

`docker build -t doc2xlsx .`

Чтобы запустить Docker вместе с приложением, нужно выполнить следующую команду:

`docker run -d --name doc2xlsx_container -p 8000:8000 doc2xlsx`

Проверить работу решения можно с помощью следующей команды:

`curl -X POST "http://localhost:8000/convert" -F "file=@E:\WINK\Input.docx" --output Output.xlsx`

ИЛИ

Запустить в адресной строке `http://localhost:8000/docs` и выбрать файл вручную.
